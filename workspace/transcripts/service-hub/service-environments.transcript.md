When your organization has multiple environments like in this case the ACM eCorp organization has several different environments Shared infra stage UID however you may want different services to be deployed to different environments only and the way that is handled is by placing the customise folder in your repo and your customize will have a base directory and one overlay directory for each environment you want to deploy your service to so let's say your project has a Dev and stage and for whatever reason you want this service to be deployed only to these two environments and you happen to add another directory called UAT because this organization also has UAT so let's say we go to we clone this repo I already have it cloned so I am going to open this repository in VS code and let's we all also have we copy this and we paste it as UAT and change the environment to UAT okay now when you do a Git commit push obviously this service is going to be right now it is being deployed to Dev and stage it is this one is Dev. So the service is going being deployed to dev and stage so when we make a Git commit push because because this service now the overlay folder also has UAT environment in it you would see UAT also here let's see so git add. Git commit hyphen AM added UAT to customize so git push so when we do this we expect a pipeline to be triggered on planton cloud with the new commit that we just pushed which the once we receive the webhook notification we should see the pipeline and we see that a new pipeline is already running with the same commit message that we saw, which is added UAT to customize. Once the build stage is completed, we will see that our folders have been added in the customized folder, we'll see one deployment task for each of those environments. Right now, we only see dev and stage. That is because we have added only dev and stage. Ideally, we expected to see all dev, stage, and UAT. However, within service definition, if you add any set of environments, then the pipeline will ignore the other environments that are located in customized. Right here, if we refresh the base and overlays as dev, stage, and UAT but the pipeline currently shows only dev and stage. That is because the service has deployment environment set to dev and stage. Now let's go ahead and add UAT to the mix and let's create another pipeline to the same main branch. When the new pipeline gets created, we'll again see the deployment tasks added to that. Another pipeline just got started, and if we open it, the build step is still running. We'll wait until the step is completed. Now, the build stage is just completed, and as you can see, Dev, Stage, and UAT are all included. This demonstrates how you can control which environments your service gets deployed to. Another important point here is if you do not select any of these environments, what happens is that the service will be configured to deploy to all environments found under the customized directory in the repository. Whatever overlay directories you have, the service will automatically be deployed to all these environments, and that is the default behavior by the way. So this deployment environments configuration is specifically added for those services where you have reasons to put multiple overlay directories in your customized directory but a particular service should only select a subset of the overlay directories. Let's say I now want to only deploy this service to Dev and nothing else. So the next pipeline that I am going to create is only going to be deployed to Dev. I hope this explains how you can configure your pipelines to make sure that given service on Planton Cloud will only be deployed to a select environment without ignoring other environments in your customized directory.
